# API仕様書

## 概要

- **ベースURL**: `https://api.example.com/v1`
- **認証方式**: Bearer Token (JWT)
- **レスポンス形式**: JSON

## 共通仕様

### リクエストヘッダー
| ヘッダー | 必須 | 説明 |
|----------|------|------|
| Authorization | ○ | `Bearer {token}` |
| Content-Type | ○ | `application/json` |

### エラーレスポンス
```json
{
  "error": {
    "code": "ERROR_CODE",
    "message": "エラーメッセージ",
    "details": {}
  }
}
```

### ステータスコード
| コード | 説明 |
|--------|------|
| 200 | 成功 |
| 201 | 作成成功 |
| 400 | リクエスト不正 |
| 401 | 認証エラー |
| 403 | 権限エラー |
| 404 | リソース不存在 |
| 422 | バリデーションエラー |
| 500 | サーバーエラー |

## エンドポイント一覧

| メソッド | パス | 説明 | 認証 |
|----------|------|------|------|
| POST | /auth/login | ログイン | 不要 |
| POST | /auth/register | ユーザー登録 | 不要 |
| GET | /users/me | 自分の情報取得 | 必要 |
| GET | /posts | 投稿一覧取得 | 必要 |
| POST | /posts | 投稿作成 | 必要 |
| GET | /posts/{id} | 投稿詳細取得 | 必要 |
| PUT | /posts/{id} | 投稿更新 | 必要 |
| DELETE | /posts/{id} | 投稿削除 | 必要 |

## 詳細

### POST /auth/login
ユーザーログイン

#### リクエスト
```json
{
  "email": "user@example.com",
  "password": "password123"
}
```

#### レスポンス (200)
```json
{
  "token": "eyJhbGciOiJIUzI1NiIs...",
  "user": {
    "id": "uuid",
    "email": "user@example.com",
    "name": "ユーザー名"
  }
}
```

#### エラー
| コード | 説明 |
|--------|------|
| 401 | メールアドレスまたはパスワードが間違っています |

---

### GET /posts
投稿一覧を取得

#### クエリパラメータ
| パラメータ | 型 | 必須 | 説明 |
|------------|-----|------|------|
| page | number | × | ページ番号（デフォルト: 1） |
| limit | number | × | 取得件数（デフォルト: 20, 最大: 100） |

#### レスポンス (200)
```json
{
  "data": [
    {
      "id": "uuid",
      "title": "タイトル",
      "content": "本文",
      "user": {
        "id": "uuid",
        "name": "作成者名"
      },
      "createdAt": "2025-01-01T00:00:00Z"
    }
  ],
  "pagination": {
    "page": 1,
    "limit": 20,
    "total": 100,
    "totalPages": 5
  }
}
```

---

### POST /posts
投稿を作成

#### リクエスト
```json
{
  "title": "タイトル",
  "content": "本文"
}
```

#### レスポンス (201)
```json
{
  "id": "uuid",
  "title": "タイトル",
  "content": "本文",
  "createdAt": "2025-01-01T00:00:00Z"
}
```

#### エラー
| コード | 説明 |
|--------|------|
| 422 | バリデーションエラー |

---

### GET /posts/{id}
投稿詳細を取得

#### パスパラメータ
| パラメータ | 型 | 説明 |
|------------|-----|------|
| id | UUID | 投稿ID |

#### レスポンス (200)
```json
{
  "id": "uuid",
  "title": "タイトル",
  "content": "本文",
  "user": {
    "id": "uuid",
    "name": "作成者名"
  },
  "createdAt": "2025-01-01T00:00:00Z",
  "updatedAt": "2025-01-01T00:00:00Z"
}
```

#### エラー
| コード | 説明 |
|--------|------|
| 404 | 投稿が見つかりません |

---

### PUT /posts/{id}
投稿を更新

#### パスパラメータ
| パラメータ | 型 | 説明 |
|------------|-----|------|
| id | UUID | 投稿ID |

#### リクエスト
```json
{
  "title": "更新後タイトル",
  "content": "更新後本文"
}
```

#### レスポンス (200)
```json
{
  "id": "uuid",
  "title": "更新後タイトル",
  "content": "更新後本文",
  "updatedAt": "2025-01-01T00:00:00Z"
}
```

#### エラー
| コード | 説明 |
|--------|------|
| 403 | この投稿を編集する権限がありません |
| 404 | 投稿が見つかりません |

---

### DELETE /posts/{id}
投稿を削除

#### パスパラメータ
| パラメータ | 型 | 説明 |
|------------|-----|------|
| id | UUID | 投稿ID |

#### レスポンス (204)
No Content

#### エラー
| コード | 説明 |
|--------|------|
| 403 | この投稿を削除する権限がありません |
| 404 | 投稿が見つかりません |
